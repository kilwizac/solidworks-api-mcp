
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
    <meta name="Microsoft.Help.SelfBranded" content="true" />

    <title>RunMacro2 Method</title>
    <meta name="Title" content="" />
    <script src="template/packages/jquery/script/chm.mshc/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script">
</script>
    <script src="template/packages/jquery-ui/script/chm.mshc/jquery-ui-1.8.18.custom.min.js" type="text/javascript">
</script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/chm.mshc/jquery-ui-1.8.18.custom.css" />
    <script type="text/javascript">
//<![CDATA[
    var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{versions:{popupContainer:'#i-after-header-content'}}},{settings:{"currentLocale":"-","isFrameless":false,"versions":{"locale":{"currentId":"-"}}}});
    //]]>
    </script>
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-dotnet/css/chm.mshc/jquery-plugins.css" />
    <link rel="stylesheet" type="text/css" href="template/packages/core-dotnet/css/dx.net.css" data-mshv2-stylesheet="/template/packages/core-dotnet/dx.net.mshv2.css" data-mshv1-stylesheet="/template/packages/core-dotnet/dx.net.mshv1.css" data-responsive-mobile="template/packages/core-dotnet/dx.net.mobile.css" data-responsive-tablet="template/packages/core-dotnet/dx.net.tablet.css" />
    <script src="template/packages/plugins-dotnet/script/chm.mshc/jquery-plugins.min.js" type="text/javascript">
</script>
    <script src="template/packages/core-dotnet/script/dx.net.min.js" type="text/javascript">
</script>
    <meta name="Microsoft.Help.Id" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~RunMacro2" />
    <meta name="Description" content="Runs a macro from a project file." />
    <meta name="Microsoft.Help.TocParent" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_methods" />
    <meta name="Microsoft.Help.ContentType" content="Reference" />
    <meta name="Microsoft.Help.F1" content="SolidWorks.Interop.sldworks.ISldWorks.RunMacro2" />
    <meta name="Microsoft.Help.Keywords" content="Macros, run" />
    <meta name="Microsoft.Help.Keywords" content="RunMacro2 Method" />
    <meta name="Microsoft.Help.Locale" content="en-US" />
    <meta name="Microsoft.Help.TopicLocale" content="en-US" />
</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content"></div>

    <div id="i-header-content" class="i-header-content">
        <div class="i-project-title">
            SOLIDWORKS API Help
        </div>

        <div class="i-page-title">
            <div class="i-page-title-text">
                RunMacro2 Method
            </div>
        </div>
    </div>

    <div id="i-after-header-content" class="i-after-header-content">
        <!-- Spacing --> <span class="i-toggle-all-sections i-function-link"><label class="i-collapse-all">Collapse All</label>&#160;<label class="i-expand-all" style="display: none;">Expand All</label></span> <!-- Spacing --> <span class="i-language-filter i-popup-link" data-popup-contentsource="#i-language-options" data-popup-title='Language Filter'><label class="i-language-filter-all">Language Filter: All</label>&#160;<label class="i-language-filter-multiple" style="display: none;">Language Filter: Multiple</label>&#160;<label class="i-language-filter-vball" style="display: none;">Language Filter: Visual Basic</label>&#160;<label class="i-VB-label" style="display: none;">Language Filter: Visual Basic (Declaration)</label>&#160;<label class="i-VBUsage-label" style="display: none;">Language Filter: Visual Basic (Usage)</label>&#160;<label class="i-CS-label" style="display: none;">Language Filter: C#</label>&#160;<label class="i-CPP2005-label" style="display: none;">Language Filter: C++/CLI</label></span>

        <div class="i-popup-content" id="i-language-options">
            <input data-languagename="VB" id="i-VB-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VB" /> <label class="i-language-filter" for="i-VB-language-checkbox">Visual Basic (Declaration)</label><br />
            <input data-languagename="VBUsage" id="i-VBUsage-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VBUsage" /> <label class="i-language-filter" for="i-VBUsage-language-checkbox">Visual Basic (Usage)</label><br />
            <input data-languagename="CS" id="i-CS-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CS" /> <label class="i-language-filter" for="i-CS-language-checkbox">C#</label><br />
            <input data-languagename="CPP2005" id="i-CPP2005-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CPP2005" /> <label class="i-language-filter" for="i-CPP2005-language-checkbox">C++/CLI</label>
        </div>
    </div>

    <div class="i-breadcrumbs-container">
        <table>
            <tr>
                <td><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a> &gt; <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks">ISldWorks Interface</a> : RunMacro2 Method</td>
            </tr>
        </table>
    </div>

    <div id="FilePathNamePopupContent" class="i-popup-content">
        Path and filename of the project file containing the macro
    </div>

    <div id="ModuleNamePopupContent" class="i-popup-content">
        Name of the module in the macro
    </div>

    <div id="ProcedureNamePopupContent" class="i-popup-content">
        Name of the procedure in the module
    </div>

    <div id="OptionsPopupContent" class="i-popup-content">
        Option as defined <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swRunMacroOption_e.html">swRunMacroOption_e</a>&#160;(supports VBA macros only)
    </div>

    <div id="ErrorPopupContent" class="i-popup-content">
        Error&#160;as defined by <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swRunMacroError_e.html">swRunMacroError_e</a>&#160;(supports VBA macros only)
    </div>

    <div id="i-body-content" class="i-body-content">
        <div class="i-description-content">
            Runs a macro from a project file.
        </div>

        <div class="i-section-heading" id="i-syntax-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Syntax</span>
        </div>

        <div id="i-syntax-section-content" class="i-section-content">
            <div class="i-tab-container i-tab-container">
                <ul>
                    <li class="i-filtered-content-VB"><a href="#i-syntax-VB">Visual Basic (Declaration)</a></li>

                    <li class="i-filtered-content-VBUsage"><a href="#i-syntax-VBUsage">Visual Basic (Usage)</a></li>

                    <li class="i-filtered-content-CS"><a href="#i-syntax-CS">C#</a></li>

                    <li class="i-filtered-content-CPP2005"><a href="#i-syntax-CPP2005">C++/CLI</a></li>
                </ul>

                <div id="i-syntax-VB" class="i-filtered-content-VB">
                    <pre>
Function RunMacro2( _
   ByVal <i><a class="i-popup-link" id="FilePathNamePopupLink" data-popup-contentsource="#FilePathNamePopupContent" data-popup-showevent="click mouseenter">FilePathName</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="ModuleNamePopupLink" data-popup-contentsource="#ModuleNamePopupContent" data-popup-showevent="click mouseenter">ModuleName</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="ProcedureNamePopupLink" data-popup-contentsource="#ProcedureNamePopupContent" data-popup-showevent="click mouseenter">ProcedureName</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="OptionsPopupLink" data-popup-contentsource="#OptionsPopupContent" data-popup-showevent="click mouseenter">Options</a></i> As System.Integer, _
   ByRef <i><a class="i-popup-link" id="ErrorPopupLink" data-popup-contentsource="#ErrorPopupContent" data-popup-showevent="click mouseenter">Error</a></i> As System.Integer _
) As System.Boolean
</pre>
                </div>

                <div id="i-syntax-VBUsage" class="i-filtered-content-VBUsage">
                    <pre>
Dim instance As <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks">ISldWorks</a>
Dim FilePathName As System.String
Dim ModuleName As System.String
Dim ProcedureName As System.String
Dim Options As System.Integer
Dim Error As System.Integer
Dim value As System.Boolean
 
value = instance.RunMacro2(FilePathName, ModuleName, ProcedureName, Options, Error)
</pre>
                </div>

                <div id="i-syntax-CS" class="i-filtered-content-CS">
                    <pre>
System.bool RunMacro2( 
   System.string <i><a class="i-popup-link" id="FilePathNamePopupLink" data-popup-contentsource="#FilePathNamePopupContent" data-popup-showevent="click mouseenter">FilePathName</a></i>,
   System.string <i><a class="i-popup-link" id="ModuleNamePopupLink" data-popup-contentsource="#ModuleNamePopupContent" data-popup-showevent="click mouseenter">ModuleName</a></i>,
   System.string <i><a class="i-popup-link" id="ProcedureNamePopupLink" data-popup-contentsource="#ProcedureNamePopupContent" data-popup-showevent="click mouseenter">ProcedureName</a></i>,
   System.int <i><a class="i-popup-link" id="OptionsPopupLink" data-popup-contentsource="#OptionsPopupContent" data-popup-showevent="click mouseenter">Options</a></i>,
   out System.int <i><a class="i-popup-link" id="ErrorPopupLink" data-popup-contentsource="#ErrorPopupContent" data-popup-showevent="click mouseenter">Error</a></i>
)
</pre>
                </div>

                <div id="i-syntax-CPP2005" class="i-filtered-content-CPP2005">
                    <pre>
System.bool RunMacro2( 
   System.String^ <i><a class="i-popup-link" id="FilePathNamePopupLink" data-popup-contentsource="#FilePathNamePopupContent" data-popup-showevent="click mouseenter">FilePathName</a></i>,
   System.String^ <i><a class="i-popup-link" id="ModuleNamePopupLink" data-popup-contentsource="#ModuleNamePopupContent" data-popup-showevent="click mouseenter">ModuleName</a></i>,
   System.String^ <i><a class="i-popup-link" id="ProcedureNamePopupLink" data-popup-contentsource="#ProcedureNamePopupContent" data-popup-showevent="click mouseenter">ProcedureName</a></i>,
   System.int <i><a class="i-popup-link" id="OptionsPopupLink" data-popup-contentsource="#OptionsPopupContent" data-popup-showevent="click mouseenter">Options</a></i>,
   [Out] System.int <i><a class="i-popup-link" id="ErrorPopupLink" data-popup-contentsource="#ErrorPopupContent" data-popup-showevent="click mouseenter">Error</a></i>
) 
</pre>
                </div>
            </div>

            <h4 class="dxh4">Parameters</h4>

            <dl>
                <dt><i>FilePathName</i></dt>

                <dd>Path and filename of the project file containing the macro</dd>

                <dt><i>ModuleName</i></dt>

                <dd>Name of the module in the macro</dd>

                <dt><i>ProcedureName</i></dt>

                <dd>Name of the procedure in the module</dd>

                <dt><i>Options</i></dt>

                <dd>Option as defined <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swRunMacroOption_e.html">swRunMacroOption_e</a>&#160;(supports VBA macros only)</dd>

                <dt><i>Error</i></dt>

                <dd>Error&#160;as defined by <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swRunMacroError_e.html">swRunMacroError_e</a>&#160;(supports VBA macros only)</dd>
            </dl>

            <h4 class="dxh4">Return Value</h4>

            <div class="i-returns-content">
                True if macro runs, false if not
            </div>
        </div>

        <div class="i-section-heading" id="i-remarks-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Remarks</span>
        </div>

        <div id="i-remarks-section-content" class="i-section-content">
            <p>If you specify swRunMacroUnloadAfterRun for Options, then the macro is unloaded from the VBA IDE after running.</p>

            <p>Use the path and filename of&#160;the compiled DLL for the FilePathName argument&#160;for a .NET macro.&#160;By default, the&#160;procedure is called <strong>Main</strong> in a C# macro. Because C# is case sensitive, you must specify <strong>Main</strong> for ProcedureName in this method.. See&#160;<strong>Running a C#&#160;DLL from VBA</strong>&#160;in the <strong>Example</strong> section.</p>

            <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'; COLOR: black; mso-fareast-font-family: 'Times New Roman'">Running a macro from an add-in application, standalone .</span><span style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'; COLOR: black; mso-fareast-font-family: 'Times New Roman'; mso-bidi-font-size: 12.0pt">exe</span><span style="FONT-SIZE: 8pt; FONT-FAMILY: 'Verdana','sans-serif'; COLOR: black; mso-fareast-font-family: 'Times New Roman'">, or VBA macro is supported. Running a&#160;.NET macro from a .NET macro is also supported, but only if both .NET macros were created using the same VSTA version.</span></p>

            <p class="MsoNormal" style="MARGIN: 0in 0in 0pt">&#160;</p>

            <p>See <a href="sldworksAPIProgGuide.chm::/GettingStarted/SOLIDWORKS_Macros.htm">SOLIDWORKS Macros</a>&#160;for details.</p>
        </div><a name="exampleBookmark"></a>

        <div class="i-section-heading" id="i-example-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Example</span>
        </div>

        <div id="i-example-section-content" class="i-section-content">
            <p><strong>Visual Basic for Applications (VBA)</strong></p>

            <ol>
                <li>Create two VBA macros using the following code samples.</li>

                <li>Store <strong>RunMacroSub.swp</strong>&#160;in <strong>c:\test</strong>.&#160;</li>

                <li>Run <strong>RunMacro.swp</strong>.</li>
            </ol>

            <p><font size="2" face="Courier New"><font size="2" face="Courier New">'----------------------------<br /></font></font><font size="2" face="Courier New"><font size="2" face="Courier New">' RunMacro.swp<br /></font></font><font size="2" face="Courier New"><font size="2" face="Courier New">'---------------------------</font></font></p>

            <p><font size="2" face="Courier New"><font size="2" face="Courier New">Option Explicit</font></font><font size="2" face="Courier New"><br />
            <font size="2" face="Courier New">Dim swApp As SldWorks.SldWorks<br />
            Dim boolstatus As Boolean</font></font><font size="2" face="Courier New"><br />
            <font size="2" face="Courier New">Sub main()<br />
            &#160;&#160;</font></font>&#160;<font size="2" face="Courier New"><font size="2" face="Courier New">Set swApp = Application.SldWorks<br />
            &#160;&#160; Dim runMacroError As Long<br />
            &#160;&#160; boolstatus = swApp.<strong>RunMacro2</strong>("c:\test\RunMacroSub.swp", "RunMacroSub1", "main",&#160;&#160; swRunMacroUnloadAfterRun, runMacroError)<br /></font></font><font size="2" face="Courier New"><font size="2" face="Courier New">End Sub</font></font></p>

            <p><font size="2" face="Courier New"><font size="2" face="Courier New">'---------------------------------------<br />
            ' RunMacroSub.swp<br />
            '---------------------------------------<br />
            Option Explicit<br />
            Dim swApp As SldWorks.SldWorks</font></font><font size="2" face="Courier New"><br />
            <font size="2" face="Courier New">Sub alternate()<br />
            &#160;&#160; Set swApp = Application.SldWorks<br />
            &#160;&#160; swApp.SendMsgToUser "RunMacroSub1:alternate() called."<br />
            End Sub</font></font><font size="2" face="Courier New"><br />
            <font size="2" face="Courier New">Sub main()<br />
            &#160;&#160; Set swApp = Application.SldWorks<br />
            &#160;&#160; swApp.SendMsgToUser "RunMacroSub1:main() called."</font></font><font size="2" face="Courier New"><br />
            <font size="2" face="Courier New">End Sub</font></font></p>

            <p><br />
            <strong>Running a C# DLL from VBA</strong></p>

            <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><font size="2" face="Courier New"><font size="2" face="Courier New">boolstatus = Me.swApp.<strong>RunMacro2</strong>('C:\Test\CSharpMacro\SwMacro\bin\Release\CSharpMacro.dll',</font></font></p>

            <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><font size="2" face="Courier New"><font size="2" face="Courier New">&#160;'', 'Main',&#160; swRunMacroOption_e.swRunMacroDefault, runMacroError)</font></font></p>
        </div>

        <div class="i-section-heading" id="i-requirements-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Requirements</span>
        </div>

        <div id="i-requirements-section-content" class="i-section-content">
            <p><b>Target Platforms:</b> Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2</p>
        </div><a name="seealsobookmark"></a>

        <div class="i-section-heading" id="i-seealso-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">See Also</span>
        </div>

        <div id="i-seealso-section-content" class="i-section-content">
            <h4 class="i-sub-heading">Reference</h4>

            <p><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks">ISldWorks Interface</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks_members">ISldWorks Members</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~GetCurrentMacroPathFolder">ISldWorks::GetCurrentMacroPathFolder Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~GetCurrentMacroPathName">ISldWorks::GetCurrentMacroPathName Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~GetMacroMethods">ISldWorks::GetMacroMethods Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~RunAttachedMacro">ISldWorks::RunAttachedMacro Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~RecordLine">ISldWorks::RecordLine Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~RecordLineCSharp">ISldWorks::RecordLineCSharp Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~RecordLineVBnet">ISldWorks::RecordLineVBnet Method</a></p>
        </div>
    </div>

    <div id="i-footer-content" class="i-footer-content">
        <a href="mailto:support@company.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~RunMacro2.html">Send Feedback</a>
    </div><script type="text/javascript">
//<![CDATA[
        $(function() {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.isNew = !(typeof setIsNew === "undefined");
            documentInstance.isResponsiveEnabled = !(typeof setIsResponsiveEnabled === "undefined");
            documentInstance.load();
        });
    //]]>
    </script>
</body>
</html>