
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
    <meta name="Microsoft.Help.SelfBranded" content="true" />

    <title>AddMenuItem2 Method (IFrame)</title>
    <meta name="Title" content="" />
    <script src="template/packages/jquery/script/chm.mshc/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script">
</script>
    <script src="template/packages/jquery-ui/script/chm.mshc/jquery-ui-1.8.18.custom.min.js" type="text/javascript">
</script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/chm.mshc/jquery-ui-1.8.18.custom.css" />
    <script type="text/javascript">
//<![CDATA[
    var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{versions:{popupContainer:'#i-after-header-content'}}},{settings:{"currentLocale":"-","isFrameless":false,"versions":{"locale":{"currentId":"-"}}}});
    //]]>
    </script>
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-dotnet/css/chm.mshc/jquery-plugins.css" />
    <link rel="stylesheet" type="text/css" href="template/packages/core-dotnet/css/dx.net.css" data-mshv2-stylesheet="/template/packages/core-dotnet/dx.net.mshv2.css" data-mshv1-stylesheet="/template/packages/core-dotnet/dx.net.mshv1.css" data-responsive-mobile="template/packages/core-dotnet/dx.net.mobile.css" data-responsive-tablet="template/packages/core-dotnet/dx.net.tablet.css" />
    <script src="template/packages/plugins-dotnet/script/chm.mshc/jquery-plugins.min.js" type="text/javascript">
</script>
    <script src="template/packages/core-dotnet/script/dx.net.min.js" type="text/javascript">
</script>
    <meta name="Microsoft.Help.Id" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuItem2" />
    <meta name="Description" content="Adds a menu item and bitmap or a separator to an existing menu." />
    <meta name="Microsoft.Help.TocParent" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame_methods" />
    <meta name="Microsoft.Help.ContentType" content="Reference" />
    <meta name="Microsoft.Help.F1" content="SolidWorks.Interop.sldworks.IFrame.AddMenuItem2" />
    <meta name="Microsoft.Help.Keywords" content="Menus, frames" />
    <meta name="Microsoft.Help.Keywords" content="AddMenuItem2 Method (IFrame)" />
    <meta name="Microsoft.Help.Locale" content="en-US" />
    <meta name="Microsoft.Help.TopicLocale" content="en-US" />
</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content"></div>

    <div id="i-header-content" class="i-header-content">
        <div class="i-project-title">
            SOLIDWORKS API Help
        </div>

        <div class="i-page-title">
            <div class="i-page-title-text">
                AddMenuItem2 Method (IFrame)
            </div>
        </div>
    </div>

    <div id="i-after-header-content" class="i-after-header-content">
        <!-- Spacing --> <span class="i-toggle-all-sections i-function-link"><label class="i-collapse-all">Collapse All</label>&#160;<label class="i-expand-all" style="display: none;">Expand All</label></span> <!-- Spacing --> <span class="i-language-filter i-popup-link" data-popup-contentsource="#i-language-options" data-popup-title='Language Filter'><label class="i-language-filter-all">Language Filter: All</label>&#160;<label class="i-language-filter-multiple" style="display: none;">Language Filter: Multiple</label>&#160;<label class="i-language-filter-vball" style="display: none;">Language Filter: Visual Basic</label>&#160;<label class="i-VB-label" style="display: none;">Language Filter: Visual Basic (Declaration)</label>&#160;<label class="i-VBUsage-label" style="display: none;">Language Filter: Visual Basic (Usage)</label>&#160;<label class="i-CS-label" style="display: none;">Language Filter: C#</label>&#160;<label class="i-CPP2005-label" style="display: none;">Language Filter: C++/CLI</label></span>

        <div class="i-popup-content" id="i-language-options">
            <input data-languagename="VB" id="i-VB-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VB" /> <label class="i-language-filter" for="i-VB-language-checkbox">Visual Basic (Declaration)</label><br />
            <input data-languagename="VBUsage" id="i-VBUsage-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VBUsage" /> <label class="i-language-filter" for="i-VBUsage-language-checkbox">Visual Basic (Usage)</label><br />
            <input data-languagename="CS" id="i-CS-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CS" /> <label class="i-language-filter" for="i-CS-language-checkbox">C#</label><br />
            <input data-languagename="CPP2005" id="i-CPP2005-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CPP2005" /> <label class="i-language-filter" for="i-CPP2005-language-checkbox">C++/CLI</label>
        </div>
    </div>

    <div class="i-breadcrumbs-container">
        <table>
            <tr>
                <td><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a> &gt; <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame Interface</a> : AddMenuItem2 Method</td>
            </tr>
        </table>
    </div>

    <div id="MenuPopupContent" class="i-popup-content">
        Name of the menu to which to add this&#160;menu&#160;item
    </div>

    <div id="ItemPopupContent" class="i-popup-content">
        Name of menu item (including accelerator key "&amp;"); if Item is null or empty, then this method adds a separator
    </div>

    <div id="PositionPopupContent" class="i-popup-content">
        Position at which to add the new menu item; the first item is at position 0; if Position is 1, the new menu item is added to the end of the list
    </div>

    <div id="CallbackFcnAndModulePopupContent" class="i-popup-content">
        Function called when user clicks the menu item (see <strong>Remarks</strong>)
    </div>

    <div id="BitmapFileNamePopupContent" class="i-popup-content">
        Path and filename of the bitmap for the menu item
    </div>

    <div id="i-body-content" class="i-body-content">
        <div class="i-description-content">
            Adds a menu item and bitmap or a separator to an existing menu.
        </div>

        <div class="i-section-heading" id="i-syntax-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Syntax</span>
        </div>

        <div id="i-syntax-section-content" class="i-section-content">
            <div class="i-tab-container i-tab-container">
                <ul>
                    <li class="i-filtered-content-VB"><a href="#i-syntax-VB">Visual Basic (Declaration)</a></li>

                    <li class="i-filtered-content-VBUsage"><a href="#i-syntax-VBUsage">Visual Basic (Usage)</a></li>

                    <li class="i-filtered-content-CS"><a href="#i-syntax-CS">C#</a></li>

                    <li class="i-filtered-content-CPP2005"><a href="#i-syntax-CPP2005">C++/CLI</a></li>
                </ul>

                <div id="i-syntax-VB" class="i-filtered-content-VB">
                    <pre>
Function AddMenuItem2( _
   ByVal <i><a class="i-popup-link" id="MenuPopupLink" data-popup-contentsource="#MenuPopupContent" data-popup-showevent="click mouseenter">Menu</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="ItemPopupLink" data-popup-contentsource="#ItemPopupContent" data-popup-showevent="click mouseenter">Item</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="PositionPopupLink" data-popup-contentsource="#PositionPopupContent" data-popup-showevent="click mouseenter">Position</a></i> As System.Integer, _
   ByVal <i><a class="i-popup-link" id="CallbackFcnAndModulePopupLink" data-popup-contentsource="#CallbackFcnAndModulePopupContent" data-popup-showevent="click mouseenter">CallbackFcnAndModule</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="BitmapFileNamePopupLink" data-popup-contentsource="#BitmapFileNamePopupContent" data-popup-showevent="click mouseenter">BitmapFileName</a></i> As System.String _
) As System.Boolean
</pre>
                </div>

                <div id="i-syntax-VBUsage" class="i-filtered-content-VBUsage">
                    <pre>
Dim instance As <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame</a>
Dim Menu As System.String
Dim Item As System.String
Dim Position As System.Integer
Dim CallbackFcnAndModule As System.String
Dim BitmapFileName As System.String
Dim value As System.Boolean
 
value = instance.AddMenuItem2(Menu, Item, Position, CallbackFcnAndModule, BitmapFileName)
</pre>
                </div>

                <div id="i-syntax-CS" class="i-filtered-content-CS">
                    <pre>
System.bool AddMenuItem2( 
   System.string <i><a class="i-popup-link" id="MenuPopupLink" data-popup-contentsource="#MenuPopupContent" data-popup-showevent="click mouseenter">Menu</a></i>,
   System.string <i><a class="i-popup-link" id="ItemPopupLink" data-popup-contentsource="#ItemPopupContent" data-popup-showevent="click mouseenter">Item</a></i>,
   System.int <i><a class="i-popup-link" id="PositionPopupLink" data-popup-contentsource="#PositionPopupContent" data-popup-showevent="click mouseenter">Position</a></i>,
   System.string <i><a class="i-popup-link" id="CallbackFcnAndModulePopupLink" data-popup-contentsource="#CallbackFcnAndModulePopupContent" data-popup-showevent="click mouseenter">CallbackFcnAndModule</a></i>,
   System.string <i><a class="i-popup-link" id="BitmapFileNamePopupLink" data-popup-contentsource="#BitmapFileNamePopupContent" data-popup-showevent="click mouseenter">BitmapFileName</a></i>
)
</pre>
                </div>

                <div id="i-syntax-CPP2005" class="i-filtered-content-CPP2005">
                    <pre>
System.bool AddMenuItem2( 
   System.String^ <i><a class="i-popup-link" id="MenuPopupLink" data-popup-contentsource="#MenuPopupContent" data-popup-showevent="click mouseenter">Menu</a></i>,
   System.String^ <i><a class="i-popup-link" id="ItemPopupLink" data-popup-contentsource="#ItemPopupContent" data-popup-showevent="click mouseenter">Item</a></i>,
   System.int <i><a class="i-popup-link" id="PositionPopupLink" data-popup-contentsource="#PositionPopupContent" data-popup-showevent="click mouseenter">Position</a></i>,
   System.String^ <i><a class="i-popup-link" id="CallbackFcnAndModulePopupLink" data-popup-contentsource="#CallbackFcnAndModulePopupContent" data-popup-showevent="click mouseenter">CallbackFcnAndModule</a></i>,
   System.String^ <i><a class="i-popup-link" id="BitmapFileNamePopupLink" data-popup-contentsource="#BitmapFileNamePopupContent" data-popup-showevent="click mouseenter">BitmapFileName</a></i>
) 
</pre>
                </div>
            </div>

            <h4 class="dxh4">Parameters</h4>

            <dl>
                <dt><i>Menu</i></dt>

                <dd>Name of the menu to which to add this&#160;menu&#160;item</dd>

                <dt><i>Item</i></dt>

                <dd>Name of menu item (including accelerator key "&amp;"); if Item is null or empty, then this method adds a separator</dd>

                <dt><i>Position</i></dt>

                <dd>Position at which to add the new menu item; the first item is at position 0; if Position is 1, the new menu item is added to the end of the list</dd>

                <dt><i>CallbackFcnAndModule</i></dt>

                <dd>Function called when user clicks the menu item (see <strong>Remarks</strong>)</dd>

                <dt><i>BitmapFileName</i></dt>

                <dd>Path and filename of the bitmap for the menu item</dd>
            </dl>

            <h4 class="dxh4">Return Value</h4>

            <div class="i-returns-content">
                True if menu item is added, false if not
            </div>
        </div>

        <div class="i-section-heading" id="i-remarks-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Remarks</span>
        </div>

        <div id="i-remarks-section-content" class="i-section-content">
            <p class="apiRemarksText">This method only works for the C++ application implemented as a DLL, not as an EXE. Any function exposed as a callback from a menu item must be declared as an EXPORT or included in your .def file.</p>

            <p class="apiRemarksText">You can add a new menu item to any one of the four frames (main frame, part frame, assembly frame, or drawing frame). To do this, you must get the <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame</a> object when the desired frame is active.</p>

            <p class="apiRemarksText">For example, if you want your menu to be available when a part document is active, then call <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~Frame">ISldWorks::Frame</a> when a part is first loaded or created, and use that IFrame object to call this method. Once you add your menu to the part frame, you do not need to do it again during the current SOLIDWORKS Design session.</p>

            <p class="apiRemarksText">The CallbackFcnAndModule argument specifies which function to call when this menu item is selected by the user. The syntax is as follows:</p>

            <p class="apiCode" style="MARGIN-LEFT: 49px">"dllname@function@updatefunction,hintstring"</p>

            <p class="apiRemarksText" style="FONT-WEIGHT: normal; FONT-STYLE: normal">where:</p><!--(Table)=========================================================-->

            <table style="BORDER-SPACING: 0px" x-use-null-cells="">
                <colgroup>
                    <col style="WIDTH: 18.73%" />
                    <col style="WIDTH: 81.27%" />
                </colgroup>

                <tbody>
                    <tr style="x-cell-content-align: top" valign="top">
                        <td style="PADDING-LEFT: 10px">
                            <p style='FONT-FAMILY: "Courier New", monospace, monospace'>dllname</p>
                        </td>

                        <td style="BORDER-TOP-STYLE: none; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p>Name of your library as specified in the project .def file. The actual DLL filename and the definition in the .def file must be the same.</p>
                        </td>
                    </tr>

                    <tr style="x-cell-content-align: top" valign="top">
                        <td style="BORDER-LEFT-STYLE: none; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p style='FONT-FAMILY: "Courier New", monospace, monospace'>function</p>
                        </td>

                        <td style="BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p>Name of the function that gets called when the user clicks the menu item. This function must also be declared as an EXPORT in your .def file.</p>

                            <p class="apiRemarksText">See <a href="sldworksapiprogguide.chm::/OVERVIEW/Add-in_Callbacks.htm">Add-in Callback and Enable Methods</a>&#160;to learn how to specify your function.</p>
                        </td>
                    </tr>

                    <tr style="x-cell-content-align: top" valign="top">
                        <td style="BORDER-LEFT-STYLE: none; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p style='FONT-FAMILY: "Courier New", monospace, monospace'>updatefunction</p>
                        </td>

                        <td style="BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p class="apiRemarksText" style="FONT-WEIGHT: normal"><span>Optional argument that controls the state of the button. If specified, then SOLIDWORKS Design calls this function before the button is displayed. Define your updatefunction to return an integer and declare it as an EXPORT or included in your .def file. The display of the button is controlled by the return value of the function as follows:</span></p>

                            <ul>
                                <li>
                                    <div class="apiRemarksText" style="FONT-WEIGHT: normal">
                                        return 0 - Menu item is unchecked and disabled.
                                    </div>
                                </li>

                                <li>
                                    <div class="apiRemarksText" style="FONT-WEIGHT: normal">
                                        return 1 - Menu item is unchecked and enabled. This is the default menu state if no update function is specified.
                                    </div>
                                </li>

                                <li>
                                    <div class="apiRemarksText" style="FONT-WEIGHT: normal">
                                        return 2&#160;- Menu item is checked and disabled.
                                    </div>
                                </li>

                                <li>
                                    <div class="apiRemarksText" style="FONT-WEIGHT: normal">
                                        return 3&#160;- Menu item is checked and enabled.
                                    </div>
                                </li>
                            </ul>

                            <p class="apiRemarksText">See <a href="sldworksapiprogguide.chm::/OVERVIEW/Add-in_Callbacks.htm">Add-in Callback and Enable Methods</a>&#160;to learn how to specify your updatefunction.</p>
                        </td>
                    </tr>

                    <tr style="x-cell-content-align: top" valign="top">
                        <td style="BORDER-LEFT-STYLE: none; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p style='FONT-FAMILY: "Courier New", monospace, monospace'>hintstring</p>
                        </td>

                        <td style="BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 10px">
                            <p>Optional argument that contains a text hint displayed in the SOLIDWORKS Design status bar when the user moves the mouse over this menu item. If&#160;hintstring is specified, then it must be preceded by a comma. For example:</p>

                            <p class="apiRemarksText" style='FONT-FAMILY: "Courier New", monospace, monospace; FONT-WEIGHT: normal'>"Userdll@AddBox@checkForUserSelects,Add a box"</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div><a name="exampleBookmark"></a>

        <div class="i-section-heading" id="i-requirements-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Requirements</span>
        </div>

        <div id="i-requirements-section-content" class="i-section-content">
            <p><b>Target Platforms:</b> Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2</p>
        </div><a name="seealsobookmark"></a>

        <div class="i-section-heading" id="i-seealso-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">See Also</span>
        </div>

        <div id="i-seealso-section-content" class="i-section-content">
            <h4 class="i-sub-heading">Reference</h4>

            <p><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame Interface</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame_members">IFrame Members</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenu">AddMenu Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~GetSubMenuCount">IFrame::GetSubMenuCount Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~GetSubMenus">IFrame::GetSubMenus Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~IGetSubMenus">IFrame::IGetSubMenus Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~RemoveMenu">IFrame::RemoveMenu Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~RenameMenu">IFrame::RenameMenu Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~GetLocalizedMenuName">ISldWorks::GetLocalizedMenuName Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuPopupIcon">IFrame::AddMenuPopupIcon Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~RemoveMenuPopupIcon">IFrame::RemoveMenuPopupIcon Method</a></p>
        </div>
    </div>

    <div id="i-footer-content" class="i-footer-content">
        <a href="mailto:support@company.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuItem2.html">Send Feedback</a>
    </div><script type="text/javascript">
//<![CDATA[
        $(function() {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.isNew = !(typeof setIsNew === "undefined");
            documentInstance.isResponsiveEnabled = !(typeof setIsResponsiveEnabled === "undefined");
            documentInstance.load();
        });
    //]]>
    </script>
</body>
</html>