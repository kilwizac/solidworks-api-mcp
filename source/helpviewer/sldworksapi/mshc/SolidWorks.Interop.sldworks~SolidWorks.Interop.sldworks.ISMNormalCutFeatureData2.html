
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
    <meta name="Microsoft.Help.SelfBranded" content="true" />

    <title>ISMNormalCutFeatureData2 Interface</title>
    <meta name="Title" content="ISMNormalCutFeatureData2 Interface" />
    <script src="template/packages/jquery/script/chm.mshc/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script">
</script>
    <script src="template/packages/jquery-ui/script/chm.mshc/jquery-ui-1.8.18.custom.min.js" type="text/javascript">
</script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/chm.mshc/jquery-ui-1.8.18.custom.css" />
    <script type="text/javascript">
//<![CDATA[
    var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{versions:{popupContainer:'#i-after-header-content'}}},{settings:{"currentLocale":"-","isFrameless":false,"versions":{"locale":{"currentId":"-"}}}});
    //]]>
    </script>
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-dotnet/css/chm.mshc/jquery-plugins.css" />
    <link rel="stylesheet" type="text/css" href="template/packages/core-dotnet/css/dx.net.css" data-mshv2-stylesheet="/template/packages/core-dotnet/dx.net.mshv2.css" data-mshv1-stylesheet="/template/packages/core-dotnet/dx.net.mshv1.css" data-responsive-mobile="template/packages/core-dotnet/dx.net.mobile.css" data-responsive-tablet="template/packages/core-dotnet/dx.net.tablet.css" />
    <script src="template/packages/plugins-dotnet/script/chm.mshc/jquery-plugins.min.js" type="text/javascript">
</script>
    <script src="template/packages/core-dotnet/script/dx.net.min.js" type="text/javascript">
</script>
    <meta name="Microsoft.Help.Id" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2" />
    <meta name="Description" content="Allows access to a sheet metal normal cut feature." />
    <meta name="Microsoft.Help.TocParent" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace" />
    <meta name="Microsoft.Help.ContentType" content="Reference" />
    <meta name="Microsoft.Help.F1" content="SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2" />
    <meta name="Microsoft.Help.Keywords" content="Feature (see also IFeature Interface),sheet metal normal cut" />
    <meta name="Microsoft.Help.Keywords" content="SMNormalCutFeatureData2. See ISMNormalCutFeatureData2 Interface." />
    <meta name="Microsoft.Help.Keywords" content="Sheet metal,Normal Cut feature" />
    <meta name="Microsoft.Help.Keywords" content="Sheet metal (see also ISheetMetalFeatureData Interface), Normal Cut" />
    <meta name="Microsoft.Help.Keywords" content="ISMNormalCutFeatureData2 Interface" />
    <meta name="Microsoft.Help.Locale" content="en-US" />
    <meta name="Microsoft.Help.TopicLocale" content="en-US" />
</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content"></div>

    <div id="i-header-content" class="i-header-content">
        <div class="i-project-title">
            SOLIDWORKS API Help
        </div>

        <div class="i-page-title">
            <div class="i-page-title-text">
                ISMNormalCutFeatureData2 Interface
            </div>
        </div>
    </div>

    <div id="i-after-header-content" class="i-after-header-content">
        <a class="i-page-link" href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2_members">Members</a>&#160; <!-- Spacing --> <span class="i-toggle-all-sections i-function-link"><label class="i-collapse-all">Collapse All</label>&#160;<label class="i-expand-all" style="display: none;">Expand All</label></span> <!-- Spacing --> <span class="i-language-filter i-popup-link" data-popup-contentsource="#i-language-options" data-popup-title='Language Filter'><label class="i-language-filter-all">Language Filter: All</label>&#160;<label class="i-language-filter-multiple" style="display: none;">Language Filter: Multiple</label>&#160;<label class="i-language-filter-vball" style="display: none;">Language Filter: Visual Basic</label>&#160;<label class="i-VB-label" style="display: none;">Language Filter: Visual Basic (Declaration)</label>&#160;<label class="i-VBUsage-label" style="display: none;">Language Filter: Visual Basic (Usage)</label>&#160;<label class="i-CS-label" style="display: none;">Language Filter: C#</label>&#160;<label class="i-CPP2005-label" style="display: none;">Language Filter: C++/CLI</label></span>

        <div class="i-popup-content" id="i-language-options">
            <input data-languagename="VB" id="i-VB-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VB" /> <label class="i-language-filter" for="i-VB-language-checkbox">Visual Basic (Declaration)</label><br />
            <input data-languagename="VBUsage" id="i-VBUsage-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VBUsage" /> <label class="i-language-filter" for="i-VBUsage-language-checkbox">Visual Basic (Usage)</label><br />
            <input data-languagename="CS" id="i-CS-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CS" /> <label class="i-language-filter" for="i-CS-language-checkbox">C#</label><br />
            <input data-languagename="CPP2005" id="i-CPP2005-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CPP2005" /> <label class="i-language-filter" for="i-CPP2005-language-checkbox">C++/CLI</label>
        </div>
    </div>

    <div class="i-breadcrumbs-container">
        <table>
            <tr>
                <td><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a> : ISMNormalCutFeatureData2 Interface</td>
            </tr>
        </table>
    </div>

    <div id="i-body-content" class="i-body-content">
        <div class="i-description-content">
            Allows access to a sheet metal normal cut feature.
        </div>

        <div class="i-section-heading" id="i-syntax-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Syntax</span>
        </div>

        <div id="i-syntax-section-content" class="i-section-content">
            <div class="i-tab-container i-tab-container">
                <ul>
                    <li class="i-filtered-content-VB"><a href="#i-syntax-VB">Visual Basic (Declaration)</a></li>

                    <li class="i-filtered-content-VBUsage"><a href="#i-syntax-VBUsage">Visual Basic (Usage)</a></li>

                    <li class="i-filtered-content-CS"><a href="#i-syntax-CS">C#</a></li>

                    <li class="i-filtered-content-CPP2005"><a href="#i-syntax-CPP2005">C++/CLI</a></li>
                </ul>

                <div id="i-syntax-VB" class="i-filtered-content-VB">
                    <pre>
Public Interface ISMNormalCutFeatureData2 
</pre>
                </div>

                <div id="i-syntax-VBUsage" class="i-filtered-content-VBUsage">
                    <pre>
Dim instance As <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2">ISMNormalCutFeatureData2</a>
</pre>
                </div>

                <div id="i-syntax-CS" class="i-filtered-content-CS">
                    <pre>
public interface ISMNormalCutFeatureData2 
</pre>
                </div>

                <div id="i-syntax-CPP2005" class="i-filtered-content-CPP2005">
                    <pre>
public interface class ISMNormalCutFeatureData2 
</pre>
                </div>
            </div>
        </div>

        <div class="i-section-heading" id="i-remarks-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Remarks</span>
        </div>

        <div id="i-remarks-section-content" class="i-section-content">
            <p>Extruded cuts&#160;that pierce models at an angle&#160;have non-normal side walls. To make these side walls normal, you create a normal cut feature.</p>

            <p>To create a normal cut feature:</p>

            <ol>
                <li>Open a sheet metal part that has a cut-extrude with non-normal side walls.</li>

                <li>Call IFeatureManager::CreateDefinition(swFmNormalCut) to access this interface.</li>

                <li>Set non-entity properties on this interface.</li>

                <li>Use&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension~SelectByRay">IModelDocExtension::SelectByRay</a> or&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDocExtension~SelectByID2">IModelDocExtension::SelectByID2</a> with Mark =&#160;4 to select the offset plane, only if&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~NormalCutParameters">ISMNormalCutFeatureData2::NormalCutParameters</a> is set to <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SolidWorks.Interop.swconst~SolidWorks.Interop.swconst.swNormalCutParameters_e.html">swNormalCutParameters_e</a>.swNormalCutOffsetPlane.</li>

                <li>Use IModelDocExtension::SelectByRay or IModelDocExtension::SelectByID2 with Mark =&#160;8 to select the direction of the normal cut, only if ISMNormalCutFeatureData2::NormalCutParameters is set to swNormalCutParameters_e.swNormalCutExtent.</li>

                <li>Use IModelDocExtension::SelectByRay or IModelDocExtension::SelectByID2 with Mark =&#160;1 to select each non-normal face in the group. If&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~AutoPropagation">ISMNormalCutFeatureData2::AutoPropagation</a> is set to true, then all faces tangent to a selected face are automatically added to the face group.</li>

                <li>Call <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~CreateGroup">ISMNormalCutFeatureData2::CreateGroup</a> to access&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutGroupData">ISMNormalCutGroupData</a>.</li>

                <li>Repeat steps&#160;6 and&#160;7 as many times as you have face groups. Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IModelDoc2~ClearSelection2">IModelDoc2::ClearSelection2</a> after each face group is created.</li>

                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~CreateFeature">IFeatureManager::CreateFeature</a>.</li>
            </ol>

            <p>To edit a normal cut feature:</p>

            <ol>
                <li>Call IFeature::GetDefinition to get this feature data object for a selected normal cut feature.</li>

                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~AccessSelections">ISMNormalCutFeatureData2::AccessSelections</a>. <strong>Note:</strong>&#160;<strong>Any selections made *<em>before*</em> this call are invalid. To&#160;edit the&#160;properties of this feature, you must re-select their entities&#160;during the editing session, i.e., after calling ISMNormalCutFeatureData2::AccessSelections. (See step 5.)</strong></li>

                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~GetGroupNames">ISMNormalCutFeatureData2::GetGroupNames</a> and&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~GetGroupByName">ISMNormalCutFeatureData2::GetGroupByName</a> to access&#160;ISMNormalCutGroupData for an existing face group.</li>

                <li>Call&#160;ISMNormalCutFeatureData2::CreateGroup to create another face group if needed.</li>

                <li>Modify&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~CutDirection">cut direction</a>,&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~OffsetPlaneReference">offset plane reference</a>, or other properties on ISMNormalCutFeatureData2 as needed. To select property entities, use IModelDocExtension::SelectByRay or IModelDocExtension::SelectByID2 followed by&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISelectionMgr~GetSelectedObject6">ISelectionMgr::GetSelectedObject6</a>. You can also use&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IEntity~Select4">IEntity::Select4</a>.</li>

                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeature~ModifyDefinition">IFeature::ModifyDefinition</a> if you modifed the feature or&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2~ReleaseSelectionAccess">ISMNormalCutFeatureData2::ReleaseSelectionAccess</a> if&#160;you did not.</li>
            </ol>
        </div><a name="exampleBookmark"></a>

        <div class="i-section-heading" id="i-example-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Example</span>
        </div>

        <div id="i-example-section-content" class="i-section-content">
            <p>'VBA</p>

            <p>'*******************************************************************</p>

            <p>'1. Open <strong>c:\Users\Public\Documents\SOLIDWORKS\SOLIDWORKS 2019\samples\whatsnew\sheet metal\normal_cut.sldprt</strong>.<br />
            '2. Open the Immediate window.<br />
            '3. Run the macro.<br />
            '4. Creates <strong>Normal Cut1</strong> in the FeatureManager design tree.<br />
            '5. Edits the feature by specifying a normal cut direction entity.<br />
            '6. Inspect the Immediate window.</p>

            <p>'****************************************************************</p>

            <p>Option Explicit<br />
            Dim swApp As SldWorks.SldWorks<br />
            Dim swModel As SldWorks.ModelDoc2<br />
            Dim swModelDocExt As SldWorks.ModelDocExtension<br />
            Dim swFeatMgr As SldWorks.FeatureManager<br />
            Dim swFeat As SldWorks.Feature<br />
            Dim swNormalCutFeatData As SldWorks.SMNormalCutFeatureData2<br />
            Dim grpData As SldWorks.SMNormalCutGroupData<br />
            Dim swSelMgr As SldWorks.SelectionMgr<br />
            Dim swCutDirectionFace As SldWorks.Face2<br />
            Dim errCode As Long<br />
            Dim boolstatus As Boolean<br />
            Dim varGrpNames As Variant<br />
            Dim i As Long<br />
            Dim j As Long<br />
            Dim Name As String<br />
            Dim Face As SldWorks.Face2</p>

            <p><br />
            Sub main()</p>

            <p>&#160;&#160;&#160; Set swApp = Application.SldWorks<br />
            &#160;&#160;&#160; Set swModel = swApp.<strong>ActiveDoc</strong><br />
            &#160;&#160;&#160; Set swModelDocExt = swModel.<strong>Extension</strong><br />
            &#160;&#160;&#160; Set swFeatMgr = swModel.<strong>FeatureManager</strong><br />
            &#160;&#160;&#160; Set swNormalCutFeatData = swFeatMgr.<strong>CreateDefinition</strong>(swFmNormalCut)<br />
            &#160;&#160;&#160; swNormalCutFeatData.<strong>AutoPropagation</strong> = True<br />
            &#160;&#160;&#160; swNormalCutFeatData.<strong>OptimizeGeometry</strong> = True<br />
            &#160;&#160;&#160; swNormalCutFeatData.<strong>NormalCutParameters</strong> = swNormalCutExtent</p>

            <p>&#160;&#160;&#160; ' Select the face(s) to make normal</p>

            <p>&#160;&#160;&#160; boolstatus = swModel.<strong>Extension</strong>.<strong>SelectByRay</strong>(4.71296104838217E-02, 1.42054003862171E-02, -6.68923799798904E-03, -0.13322686545804, 0.182153484913837, 0.974202602261958, 6.19874904830013E-04, 2, True, 1, 0)</p>

            <p>&#160;&#160;&#160; Set grpData = swNormalCutFeatData.<strong>CreateGroup</strong>(errCode)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; ' Create the normal cut feature<br />
            <br />
            &#160;&#160;&#160; Set swFeat = swFeatMgr.<strong>CreateFeature</strong>(swNormalCutFeatData)</p>

            <p>&#160;&#160;&#160; ' Modify the normal cut feature<br />
            <br />
            &#160;&#160;&#160; Set swNormalCutFeatData = swFeat.<strong>GetDefinition</strong>()<br />
            &#160;&#160;&#160; swNormalCutFeatData.<strong>AccessSelections</strong> swModel, Nothing<br />
            &#160;&#160;&#160; varGrpNames = swNormalCutFeatData.<strong>GetGroupNames</strong>()</p>

            <p>&#160;&#160;&#160; For i = 0 To UBound(varGrpNames)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Name = varGrpNames(i)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "GroupName: " &amp; Name<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Set grpData = swNormalCutFeatData.<strong>GetGroupByName</strong>(Name)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim varFaces As Variant<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; varFaces = grpData.<strong>Faces</strong><br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; For j = 0 To UBound(varFaces)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set Face = varFaces(j)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "Face " &amp; j &amp; " area: " &amp; Face.<strong>GetArea</strong><br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Next j<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "--------------------"<br />
            &#160;&#160;&#160; Next i<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; 'Specify the cut direction<br />
            <br />
            &#160;&#160;&#160; Set swSelMgr = swModel.<strong>SelectionManager</strong><br />
            &#160;&#160;&#160; boolstatus = swModel.<strong>Extension</strong>.<strong>SelectByRay</strong>(-0.149999999999892, 2.58556514245498E-02, -4.63505465353364E-03, 0.393242668518252, 0.12460738379391, -0.910951811876282, 1.22626958447854E-03, 2, False, 0, 0)<br />
            &#160;&#160;&#160; Set swCutDirectionFace = Nothing<br />
            &#160;&#160;&#160; Set swCutDirectionFace = swSelMgr.<strong>GetSelectedObject6</strong>(1, -1)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; Dim swSelectEnt As SldWorks.Entity<br />
            &#160;&#160;&#160; Set swSelectEnt = swCutDirectionFace<br />
            &#160;&#160;&#160; boolstatus = swSelectEnt.<strong>Select4</strong>(False, Nothing)<br />
            &#160;&#160;&#160; swNormalCutFeatData.<strong>CutDirection</strong> = swCutDirectionFace</p>

            <p>&#160;&#160;&#160; Dim isModified As Boolean<br />
            &#160;&#160;&#160; isModified = swFeat.<strong>ModifyDefinition</strong>(swNormalCutFeatData, swModel, Nothing)<br />
            &#160;&#160;&#160;<br />
            End Sub</p>
        </div>

        <div class="i-section-heading" id="i-example-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Example</span>
        </div>

        <div id="i-example-section-content" class="i-section-content">
            <a href="Create_Normal_Cut_Feature_Example_CSharp.htm">Create Normal Cut Feature (C#)</a>
        </div>

        <div class="i-section-heading" id="i-requirements-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Requirements</span>
        </div>

        <div id="i-requirements-section-content" class="i-section-content">
            <p><b>Target Platforms:</b> Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2</p>
        </div><a name="seealsobookmark"></a>

        <div class="i-section-heading" id="i-seealso-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">See Also</span>
        </div>

        <div id="i-seealso-section-content" class="i-section-content">
            <h4 class="i-sub-heading">Reference</h4>

            <p><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2_members">ISMNormalCutFeatureData2 Members</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a></p>
        </div>
    </div>

    <div id="i-footer-content" class="i-footer-content">
        <a href="mailto:support@company.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISMNormalCutFeatureData2.html">Send Feedback</a>
    </div><script type="text/javascript">
//<![CDATA[
        $(function() {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.isNew = !(typeof setIsNew === "undefined");
            documentInstance.isResponsiveEnabled = !(typeof setIsResponsiveEnabled === "undefined");
            documentInstance.load();
        });
    //]]>
    </script>
</body>
</html>