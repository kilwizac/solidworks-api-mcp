
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
    <meta name="Microsoft.Help.SelfBranded" content="true" />

    <title>AddMenuPopupIcon Method</title>
    <meta name="Title" content="" />
    <script src="template/packages/jquery/script/chm.mshc/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script">
</script>
    <script src="template/packages/jquery-ui/script/chm.mshc/jquery-ui-1.8.18.custom.min.js" type="text/javascript">
</script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/chm.mshc/jquery-ui-1.8.18.custom.css" />
    <script type="text/javascript">
//<![CDATA[
    var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{versions:{popupContainer:'#i-after-header-content'}}},{settings:{"currentLocale":"-","isFrameless":false,"versions":{"locale":{"currentId":"-"}}}});
    //]]>
    </script>
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-dotnet/css/chm.mshc/jquery-plugins.css" />
    <link rel="stylesheet" type="text/css" href="template/packages/core-dotnet/css/dx.net.css" data-mshv2-stylesheet="/template/packages/core-dotnet/dx.net.mshv2.css" data-mshv1-stylesheet="/template/packages/core-dotnet/dx.net.mshv1.css" data-responsive-mobile="template/packages/core-dotnet/dx.net.mobile.css" data-responsive-tablet="template/packages/core-dotnet/dx.net.tablet.css" />
    <script src="template/packages/plugins-dotnet/script/chm.mshc/jquery-plugins.min.js" type="text/javascript">
</script>
    <script src="template/packages/core-dotnet/script/dx.net.min.js" type="text/javascript">
</script>
    <meta name="Microsoft.Help.Id" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuPopupIcon" />
    <meta name="Description" content="Adds an icon to a context-sensitive menu of a C++ SOLIDWORKS add-in." />
    <meta name="Microsoft.Help.TocParent" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame_methods" />
    <meta name="Microsoft.Help.ContentType" content="Reference" />
    <meta name="Microsoft.Help.F1" content="SolidWorks.Interop.sldworks.IFrame.AddMenuPopupIcon" />
    <meta name="Microsoft.Help.Keywords" content="Menus, frames" />
    <meta name="Microsoft.Help.Keywords" content="Frame (see also IFrame Interface), menus" />
    <meta name="Microsoft.Help.Keywords" content="Context-sensitive menus" />
    <meta name="Microsoft.Help.Keywords" content="AddMenuPopupIcon Method" />
    <meta name="Microsoft.Help.Locale" content="en-US" />
    <meta name="Microsoft.Help.TopicLocale" content="en-US" />
</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content"></div>

    <div id="i-header-content" class="i-header-content">
        <div class="i-project-title">
            SOLIDWORKS API Help
        </div>

        <div class="i-page-title">
            <div class="i-page-title-text">
                AddMenuPopupIcon Method
            </div>
        </div>
    </div>

    <div id="i-after-header-content" class="i-after-header-content">
        <a class="i-page-link" href="#ExampleBookmark">Example</a>&#160;<!-- Spacing --> <span class="i-toggle-all-sections i-function-link"><label class="i-collapse-all">Collapse All</label>&#160;<label class="i-expand-all" style="display: none;">Expand All</label></span> <!-- Spacing --> <span class="i-language-filter i-popup-link" data-popup-contentsource="#i-language-options" data-popup-title='Language Filter'><label class="i-language-filter-all">Language Filter: All</label>&#160;<label class="i-language-filter-multiple" style="display: none;">Language Filter: Multiple</label>&#160;<label class="i-language-filter-vball" style="display: none;">Language Filter: Visual Basic</label>&#160;<label class="i-VB-label" style="display: none;">Language Filter: Visual Basic (Declaration)</label>&#160;<label class="i-VBUsage-label" style="display: none;">Language Filter: Visual Basic (Usage)</label>&#160;<label class="i-CS-label" style="display: none;">Language Filter: C#</label>&#160;<label class="i-CPP2005-label" style="display: none;">Language Filter: C++/CLI</label></span>

        <div class="i-popup-content" id="i-language-options">
            <input data-languagename="VB" id="i-VB-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VB" /> <label class="i-language-filter" for="i-VB-language-checkbox">Visual Basic (Declaration)</label><br />
            <input data-languagename="VBUsage" id="i-VBUsage-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VBUsage" /> <label class="i-language-filter" for="i-VBUsage-language-checkbox">Visual Basic (Usage)</label><br />
            <input data-languagename="CS" id="i-CS-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CS" /> <label class="i-language-filter" for="i-CS-language-checkbox">C#</label><br />
            <input data-languagename="CPP2005" id="i-CPP2005-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CPP2005" /> <label class="i-language-filter" for="i-CPP2005-language-checkbox">C++/CLI</label>
        </div>
    </div>

    <div class="i-breadcrumbs-container">
        <table>
            <tr>
                <td><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a> &gt; <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame Interface</a> : AddMenuPopupIcon Method</td>
            </tr>
        </table>
    </div>

    <div id="DocTypePopupContent" class="i-popup-content">
        <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swDocumentTypes_e.html">Document type</a> to which to add the context-sensitive menu icon
    </div>

    <div id="SelectTypePopupContent" class="i-popup-content">
        <a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swSelectType_e.html">Selection type</a>&#160;to which to add the context-sensitive menu icon
    </div>

    <div id="HintStringPopupContent" class="i-popup-content">
        Text&#160;displayed in the SOLIDWORKS status bar when the user moves the mouse over the icon
    </div>

    <div id="CallbackFcnAndModulePopupContent" class="i-popup-content">
        Function called when user clicks the context-sensitive menu icon (see <strong>Remarks</strong>)
    </div>

    <div id="CustomNamesPopupContent" class="i-popup-content">
        Names of custom feature types (see <strong>Remarks</strong>)
    </div>

    <div id="BitmapFilePathPopupContent" class="i-popup-content">
        Path and file name&#160;of the bitmap for the context-sensitive menu icon
    </div>

    <div id="i-body-content" class="i-body-content">
        <div class="i-description-content">
            Adds an icon&#160;to a&#160;context-sensitive menu of a C++ SOLIDWORKS add-in.
        </div>

        <div class="i-section-heading" id="i-syntax-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Syntax</span>
        </div>

        <div id="i-syntax-section-content" class="i-section-content">
            <div class="i-tab-container i-tab-container">
                <ul>
                    <li class="i-filtered-content-VB"><a href="#i-syntax-VB">Visual Basic (Declaration)</a></li>

                    <li class="i-filtered-content-VBUsage"><a href="#i-syntax-VBUsage">Visual Basic (Usage)</a></li>

                    <li class="i-filtered-content-CS"><a href="#i-syntax-CS">C#</a></li>

                    <li class="i-filtered-content-CPP2005"><a href="#i-syntax-CPP2005">C++/CLI</a></li>
                </ul>

                <div id="i-syntax-VB" class="i-filtered-content-VB">
                    <pre>
Function AddMenuPopupIcon( _
   ByVal <i><a class="i-popup-link" id="DocTypePopupLink" data-popup-contentsource="#DocTypePopupContent" data-popup-showevent="click mouseenter">DocType</a></i> As System.Integer, _
   ByVal <i><a class="i-popup-link" id="SelectTypePopupLink" data-popup-contentsource="#SelectTypePopupContent" data-popup-showevent="click mouseenter">SelectType</a></i> As System.Integer, _
   ByVal <i><a class="i-popup-link" id="HintStringPopupLink" data-popup-contentsource="#HintStringPopupContent" data-popup-showevent="click mouseenter">HintString</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="CallbackFcnAndModulePopupLink" data-popup-contentsource="#CallbackFcnAndModulePopupContent" data-popup-showevent="click mouseenter">CallbackFcnAndModule</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="CustomNamesPopupLink" data-popup-contentsource="#CustomNamesPopupContent" data-popup-showevent="click mouseenter">CustomNames</a></i> As System.String, _
   ByVal <i><a class="i-popup-link" id="BitmapFilePathPopupLink" data-popup-contentsource="#BitmapFilePathPopupContent" data-popup-showevent="click mouseenter">BitmapFilePath</a></i> As System.String _
) As System.Boolean
</pre>
                </div>

                <div id="i-syntax-VBUsage" class="i-filtered-content-VBUsage">
                    <pre>
Dim instance As <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame</a>
Dim DocType As System.Integer
Dim SelectType As System.Integer
Dim HintString As System.String
Dim CallbackFcnAndModule As System.String
Dim CustomNames As System.String
Dim BitmapFilePath As System.String
Dim value As System.Boolean
 
value = instance.AddMenuPopupIcon(DocType, SelectType, HintString, CallbackFcnAndModule, CustomNames, BitmapFilePath)
</pre>
                </div>

                <div id="i-syntax-CS" class="i-filtered-content-CS">
                    <pre>
System.bool AddMenuPopupIcon( 
   System.int <i><a class="i-popup-link" id="DocTypePopupLink" data-popup-contentsource="#DocTypePopupContent" data-popup-showevent="click mouseenter">DocType</a></i>,
   System.int <i><a class="i-popup-link" id="SelectTypePopupLink" data-popup-contentsource="#SelectTypePopupContent" data-popup-showevent="click mouseenter">SelectType</a></i>,
   System.string <i><a class="i-popup-link" id="HintStringPopupLink" data-popup-contentsource="#HintStringPopupContent" data-popup-showevent="click mouseenter">HintString</a></i>,
   System.string <i><a class="i-popup-link" id="CallbackFcnAndModulePopupLink" data-popup-contentsource="#CallbackFcnAndModulePopupContent" data-popup-showevent="click mouseenter">CallbackFcnAndModule</a></i>,
   System.string <i><a class="i-popup-link" id="CustomNamesPopupLink" data-popup-contentsource="#CustomNamesPopupContent" data-popup-showevent="click mouseenter">CustomNames</a></i>,
   System.string <i><a class="i-popup-link" id="BitmapFilePathPopupLink" data-popup-contentsource="#BitmapFilePathPopupContent" data-popup-showevent="click mouseenter">BitmapFilePath</a></i>
)
</pre>
                </div>

                <div id="i-syntax-CPP2005" class="i-filtered-content-CPP2005">
                    <pre>
System.bool AddMenuPopupIcon( 
   System.int <i><a class="i-popup-link" id="DocTypePopupLink" data-popup-contentsource="#DocTypePopupContent" data-popup-showevent="click mouseenter">DocType</a></i>,
   System.int <i><a class="i-popup-link" id="SelectTypePopupLink" data-popup-contentsource="#SelectTypePopupContent" data-popup-showevent="click mouseenter">SelectType</a></i>,
   System.String^ <i><a class="i-popup-link" id="HintStringPopupLink" data-popup-contentsource="#HintStringPopupContent" data-popup-showevent="click mouseenter">HintString</a></i>,
   System.String^ <i><a class="i-popup-link" id="CallbackFcnAndModulePopupLink" data-popup-contentsource="#CallbackFcnAndModulePopupContent" data-popup-showevent="click mouseenter">CallbackFcnAndModule</a></i>,
   System.String^ <i><a class="i-popup-link" id="CustomNamesPopupLink" data-popup-contentsource="#CustomNamesPopupContent" data-popup-showevent="click mouseenter">CustomNames</a></i>,
   System.String^ <i><a class="i-popup-link" id="BitmapFilePathPopupLink" data-popup-contentsource="#BitmapFilePathPopupContent" data-popup-showevent="click mouseenter">BitmapFilePath</a></i>
) 
</pre>
                </div>
            </div>

            <h4 class="dxh4">Parameters</h4>

            <dl>
                <dt><i>DocType</i></dt>

                <dd><a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swDocumentTypes_e.html">Document type</a> to which to add the context-sensitive menu icon</dd>

                <dt><i>SelectType</i></dt>

                <dd><a href="ms-help://SolidWorks.Interop.swconst/SolidWorks/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swSelectType_e.html">Selection type</a>&#160;to which to add the context-sensitive menu icon</dd>

                <dt><i>HintString</i></dt>

                <dd>Text&#160;displayed in the SOLIDWORKS status bar when the user moves the mouse over the icon</dd>

                <dt><i>CallbackFcnAndModule</i></dt>

                <dd>Function called when user clicks the context-sensitive menu icon (see <strong>Remarks</strong>)</dd>

                <dt><i>CustomNames</i></dt>

                <dd>Names of custom feature types (see <strong>Remarks</strong>)</dd>

                <dt><i>BitmapFilePath</i></dt>

                <dd>Path and file name&#160;of the bitmap for the context-sensitive menu icon</dd>
            </dl>

            <h4 class="dxh4">Return Value</h4>

            <div class="i-returns-content">
                True if the context-sensitive menu icon is added, false if not
            </div>
        </div>

        <div class="i-section-heading" id="i-remarks-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Remarks</span>
        </div>

        <div id="i-remarks-section-content" class="i-section-content">
            <p class="apiRemarksText">This method is supported in C++ applications only, and it&#160;only works for C++ applications implemented as <strong>.dll</strong> files, not as&#160;<strong>.exe</strong> files. Any function exposed as a callback from an context-sensitive menu icon must be declared as an EXPORT or included in your <strong>.def</strong> file.</p>

            <p class="apiRemarksText">The CallbackFcnAndModule argument specifies which function to call when the shortcut menu&#160;icon&#160;is clicked by the user. The syntax is as follows:</p>

            <p style="FONT-FAMILY: 'Courier New', monospace, monospace">dllname@function</p>

            <p class="apiCode">where:</p>

            <p class="apiRemarksText"><!--(Table)=========================================================--></p>

            <table x-use-null-cells="">
                <tbody>
                    <tr>
                        <td>
                            <p style="FONT-FAMILY: 'Courier New', monospace, monospace">dllname</p>
                        </td>

                        <td>
                            <p>Name of your library as specified in the project <strong>.def</strong> file. The actual file name and the definition in the <strong>.def</strong> file must be the same.</p>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <p style="FONT-FAMILY: 'Courier New', monospace, monospace">function</p>
                        </td>

                        <td>
                            <p>Name of the function that gets called when the user clicks the icon. This function must also be declared as an EXPORT in your <strong>.def</strong> file.</p>

                            <p class="apiRemarksText">See <a href="sldworksapiprogguide.chm::/OVERVIEW/Add-in_Callbacks.htm">Add-in Callback and Enable Methods</a>&#160;to learn how to implement your callback function.</p>
                        </td>
                    </tr>
                </tbody>
            </table>

            <p></p>

            <p>CustomNames is a semi-colon separated list of the names of the custom feature types. This argument is applicable only if SelectType is a custom feature type (like swSelATTRIBUTES); in the case of swSelATTRIBUTES, set this field to the name of the attribute definition.</p>
        </div><a name="exampleBookmark"></a>

        <div class="i-section-heading" id="i-example-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Example</span>
        </div>

        <div id="i-example-section-content" class="i-section-content">
            <div class="i-filtered-content-CPP">
                <div class="i-tab-container">
                    <ul>
                        <li><a href="#i-tab-content-237890da-8241-42db-8526-d13790097978">C++</a></li>
                    </ul>

                    <div id="i-tab-content-237890da-8241-42db-8526-d13790097978" class="i-filtered-content-">
                        <pre>
<span style="color: #008000;">//Add a single icon to the standard
//SOLIDWORKS face context menu.
</span>swFrame-&gt;AddMenuPopupIcon(
swDocPART,
swSelFACES,
CComBSTR(_T(<span style="color: #800000;">"UserPopupMenus.dll@MinibarItem1_Menu1_Callback,Facehintstring"</span>)),
CComBSTR(_T(<span style="color: #800000;">"UserPopupMenus.dll@MinibarItem1_Menu1_Callback"</span>)),
CComBSTR(_T(<span style="color: #800000;">""</span>)),
UserItem1_Menu1_bitmapFile,
&amp;iconSuccess
);
</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="i-section-heading" id="i-requirements-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Requirements</span>
        </div>

        <div id="i-requirements-section-content" class="i-section-content">
            <p><b>Target Platforms:</b> Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2</p>
        </div><a name="seealsobookmark"></a>

        <div class="i-section-heading" id="i-seealso-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">See Also</span>
        </div>

        <div id="i-seealso-section-content" class="i-section-content">
            <h4 class="i-sub-heading">Reference</h4>

            <p><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame">IFrame Interface</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame_members">IFrame Members</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~RemoveMenuPopupIcon">IFrame::RemoveMenuPopupIcon Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenu">IFrame::AddMenu Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuItem2">IFrame::AddMenuItem2 Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~GetMenu">IFrame::GetMenu Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~GetSubMenuCount">IFrame::GetSubMenuCount Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~GetSubMenus">IFrame::GetSubMenus Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~RenameMenu">IFrame::RenameMenu Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuPopupItem2">IFrame::AddMenuPopupItem2 Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuPopupIcon2">IFrame::AddMenuPopupIcon2 Method</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISldWorks~AddItemToThirdPartyPopupMenu">ISldWorks::AddItemToThirdPartyPopupMenu Method</a></p>
        </div>
    </div>

    <div id="i-footer-content" class="i-footer-content">
        <a href="mailto:support@company.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFrame~AddMenuPopupIcon.html">Send Feedback</a>
    </div><script type="text/javascript">
//<![CDATA[
        $(function() {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.isNew = !(typeof setIsNew === "undefined");
            documentInstance.isResponsiveEnabled = !(typeof setIsResponsiveEnabled === "undefined");
            documentInstance.load();
        });
    //]]>
    </script>
</body>
</html>