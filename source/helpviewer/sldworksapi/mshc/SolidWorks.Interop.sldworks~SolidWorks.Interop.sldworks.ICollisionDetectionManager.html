
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" value="IE=9" />
    <meta name="Microsoft.Help.SelfBranded" content="true" />

    <title>ICollisionDetectionManager Interface</title>
    <meta name="Title" content="ICollisionDetectionManager Interface" />
    <script src="template/packages/jquery/script/chm.mshc/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script">
</script>
    <script src="template/packages/jquery-ui/script/chm.mshc/jquery-ui-1.8.18.custom.min.js" type="text/javascript">
</script>
    <link rel="stylesheet" type="text/css" href="template/packages/jquery-ui/css/chm.mshc/jquery-ui-1.8.18.custom.css" />
    <script type="text/javascript">
//<![CDATA[
    var Innovasys=(Innovasys||{});$.extend(true,Innovasys,{settings:{versions:{popupContainer:'#i-after-header-content'}}},{settings:{"currentLocale":"-","isFrameless":false,"versions":{"locale":{"currentId":"-"}}}});
    //]]>
    </script>
    <link rel="stylesheet" type="text/css" href="template/packages/plugins-dotnet/css/chm.mshc/jquery-plugins.css" />
    <link rel="stylesheet" type="text/css" href="template/packages/core-dotnet/css/dx.net.css" data-mshv2-stylesheet="/template/packages/core-dotnet/dx.net.mshv2.css" data-mshv1-stylesheet="/template/packages/core-dotnet/dx.net.mshv1.css" data-responsive-mobile="template/packages/core-dotnet/dx.net.mobile.css" data-responsive-tablet="template/packages/core-dotnet/dx.net.tablet.css" />
    <script src="template/packages/plugins-dotnet/script/chm.mshc/jquery-plugins.min.js" type="text/javascript">
</script>
    <script src="template/packages/core-dotnet/script/dx.net.min.js" type="text/javascript">
</script>
    <meta name="Microsoft.Help.Id" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager" />
    <meta name="Description" content="Allows access to the collision detection manager." />
    <meta name="Microsoft.Help.TocParent" content="SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace" />
    <meta name="Microsoft.Help.ContentType" content="Reference" />
    <meta name="Microsoft.Help.F1" content="SolidWorks.Interop.sldworks.ICollisionDetectionManager" />
    <meta name="Microsoft.Help.Keywords" content="Collision detection" />
    <meta name="Microsoft.Help.Keywords" content="ICollisionDetectionManager Interface" />
    <meta name="Microsoft.Help.Locale" content="en-US" />
    <meta name="Microsoft.Help.TopicLocale" content="en-US" />
</head>

<body>
    <div id="i-before-header-content" class="i-before-header-content"></div>

    <div id="i-header-content" class="i-header-content">
        <div class="i-project-title">
            SOLIDWORKS API Help
        </div>

        <div class="i-page-title">
            <div class="i-page-title-text">
                ICollisionDetectionManager Interface
            </div>
        </div>
    </div>

    <div id="i-after-header-content" class="i-after-header-content">
        <a class="i-page-link" href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager_members">Members</a>&#160; <!-- Spacing --> <span class="i-toggle-all-sections i-function-link"><label class="i-collapse-all">Collapse All</label>&#160;<label class="i-expand-all" style="display: none;">Expand All</label></span> <!-- Spacing --> <span class="i-language-filter i-popup-link" data-popup-contentsource="#i-language-options" data-popup-title='Language Filter'><label class="i-language-filter-all">Language Filter: All</label>&#160;<label class="i-language-filter-multiple" style="display: none;">Language Filter: Multiple</label>&#160;<label class="i-language-filter-vball" style="display: none;">Language Filter: Visual Basic</label>&#160;<label class="i-VB-label" style="display: none;">Language Filter: Visual Basic (Declaration)</label>&#160;<label class="i-VBUsage-label" style="display: none;">Language Filter: Visual Basic (Usage)</label>&#160;<label class="i-CS-label" style="display: none;">Language Filter: C#</label>&#160;<label class="i-CPP2005-label" style="display: none;">Language Filter: C++/CLI</label></span>

        <div class="i-popup-content" id="i-language-options">
            <input data-languagename="VB" id="i-VB-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VB" /> <label class="i-language-filter" for="i-VB-language-checkbox">Visual Basic (Declaration)</label><br />
            <input data-languagename="VBUsage" id="i-VBUsage-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-VBUsage" /> <label class="i-language-filter" for="i-VBUsage-language-checkbox">Visual Basic (Usage)</label><br />
            <input data-languagename="CS" id="i-CS-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CS" /> <label class="i-language-filter" for="i-CS-language-checkbox">C#</label><br />
            <input data-languagename="CPP2005" id="i-CPP2005-language-checkbox" type="checkbox" class="i-toggle-language-checkbox" checked="true" data-toggleclass="i-filtered-content-CPP2005" /> <label class="i-language-filter" for="i-CPP2005-language-checkbox">C++/CLI</label>
        </div>
    </div>

    <div class="i-breadcrumbs-container">
        <table>
            <tr>
                <td><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a> : ICollisionDetectionManager Interface</td>
            </tr>
        </table>
    </div>

    <div id="i-body-content" class="i-body-content">
        <div class="i-description-content">
            Allows access to the collision detection manager.
        </div>

        <div class="i-section-heading" id="i-syntax-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Syntax</span>
        </div>

        <div id="i-syntax-section-content" class="i-section-content">
            <div class="i-tab-container i-tab-container">
                <ul>
                    <li class="i-filtered-content-VB"><a href="#i-syntax-VB">Visual Basic (Declaration)</a></li>

                    <li class="i-filtered-content-VBUsage"><a href="#i-syntax-VBUsage">Visual Basic (Usage)</a></li>

                    <li class="i-filtered-content-CS"><a href="#i-syntax-CS">C#</a></li>

                    <li class="i-filtered-content-CPP2005"><a href="#i-syntax-CPP2005">C++/CLI</a></li>
                </ul>

                <div id="i-syntax-VB" class="i-filtered-content-VB">
                    <pre>
Public Interface ICollisionDetectionManager 
</pre>
                </div>

                <div id="i-syntax-VBUsage" class="i-filtered-content-VBUsage">
                    <pre>
Dim instance As <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager">ICollisionDetectionManager</a>
</pre>
                </div>

                <div id="i-syntax-CS" class="i-filtered-content-CS">
                    <pre>
public interface ICollisionDetectionManager 
</pre>
                </div>

                <div id="i-syntax-CPP2005" class="i-filtered-content-CPP2005">
                    <pre>
public interface class ICollisionDetectionManager 
</pre>
                </div>
            </div>
        </div>

        <div class="i-section-heading" id="i-remarks-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Remarks</span>
        </div>

        <div id="i-remarks-section-content" class="i-section-content">
            <p>The purpose of this interface,&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionGroup">ICollisionDetectionGroup</a>, and&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollision">ICollision</a>&#160;is to provide dynamic, high-efficiency collision detection among groups of components. Collision detection is performed exclusively between collision groups: neither within collision groups nor outside of them.</p>

            <p>Please use&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IInterferenceDetectionMgr">IInterferenceDetectionMgr</a> if you need to perform static interference detection between components.</p>

            <p>Collision detection may be thought of as a series of collision detection frames. Each collision detection frame begins by setting a target assembly and two or more collision groups of components&#160;that are transformed to move to precise locations in model space. A collision detection frame may or may not&#160;end with&#160;a collision.</p>

            <p><strong>NOTE</strong>: If a collision is detected, an ICollision object is created. Be aware that ICollision objects are volatile and should not be cached for later review. ICollision objects are invalidated&#160;when a new collision detection frame begins or whenever you:</p>

            <ul>
                <li>call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager~IsCollisionPresent">ICollisionDetectionManager::IsCollisionPresent</a>.</li>

                <li>call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager~GetCollisions">ICollisionDetectionManager::GetCollisions</a>.</li>

                <li>apply&#160;new transforms to&#160;collision group&#160;components.</li>

                <li>create new or modify existing collision groups.</li>

                <li>set a new target assembly.</li>
            </ul>

            <p>Because you cannot save ICollision objects for later review, you&#160;should record the collision detection frame setup and any resulting collision components and transforms&#160;before the next collision detection frame begins.</p>

            <p>The workflow to detect collisions:</p>

            <ol>
                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager~SetAssembly">ICollisionDetectionManager::SetAssembly</a> to set the target assembly for collision detection.</li>

                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager~CreateGroup">ICollisionDetectionManager::CreateGroup</a> to create two collision groups.&#160;</li>

                <li>Call&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionGroup~SetComponents">ICollisionDetectionGroup::SetComponents</a> to populate each collision group.</li>

                <li>Use&#160;<a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionGroup~ApplyTransforms">ICollisionDetectionGroup::ApplyTransforms</a> to transform components&#160;into working positions.</li>

                <li>Call&#160;ICollisionDetectionManager::IsCollisionPresent and/or&#160;ICollisionDetectionManager::GetCollisions&#160;to detect collisions.</li>

                <li>Inspect any resulting&#160;ICollision objects. (See the NOTE above.)</li>

                <li>Repeat&#160;steps 4-6 if you want to apply new transforms for the next collision detection frame.</li>

                <li>Repeat&#160;steps&#160;2-6 if you want to change collision groups.</li>

                <li>Repeat steps 1-6 if you want to change the target assembly.</li>
            </ol>
        </div><a name="exampleBookmark"></a>

        <div class="i-section-heading" id="i-example-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Example</span>
        </div>

        <div id="i-example-section-content" class="i-section-content">
            <p>'VBA</p>

            <p>'This example demonstrates how to set up one collision detection frame.</p>

            <p>'********************************************************************<br />
            '1. Open <em>public_documents</em><strong>\samples\tutorial\api\Spindleassem.sldasm</strong>.<br />
            '2. Run the macro below.<br />
            '********************************************************************</p>

            <p><br />
            Dim swApp As SldWorks.SldWorks<br />
            Dim Part As SldWorks.ModelDoc2<br />
            Dim swDoc As SldWorks.AssemblyDoc<br />
            Dim cdm As SldWorks.CollisionDetectionManager<br />
            Dim cdg As SldWorks.CollisionDetectionGroup<br />
            Dim cdg2 As SldWorks.CollisionDetectionGroup<br />
            Dim cdg3 As SldWorks.CollisionDetectionGroup<br />
            Dim aCollision As SldWorks.Collision<br />
            Dim TransformData(15) As Double<br />
            Dim TransformDataVariant As Variant<br />
            Dim TransformData1(15) As Double<br />
            Dim TransformDataVariant1 As Variant<br />
            Dim comp(0) As SldWorks.Component2<br />
            Dim comp1(0) As SldWorks.Component2<br />
            Dim comp2(0) As SldWorks.Component2<br />
            Dim transform(0) As SldWorks.MathTransform<br />
            Dim transform1(0) As SldWorks.MathTransform<br />
            Dim var1 As Variant<br />
            Dim boolstatus As Boolean<br />
            Dim longstatus As Long<br />
            Dim numCollisions As Long<br />
            Dim i As Long<br />
            Dim j As Long<br />
            Dim comps As Variant<br />
            Option Explicit<br />
            Sub main()</p>

            <p>&#160;&#160;&#160; Set swApp = Application.SldWorks<br />
            &#160;&#160;&#160; Set Part = swApp.ActiveDoc<br />
            &#160;&#160;&#160; Set swDoc = Part<br />
            &#160;&#160;&#160; Set cdm = swApp.<strong>GetCollisionDetectionManager</strong><br />
            &#160;&#160;&#160; longstatus = cdm.<strong>SetAssembly</strong>(swDoc)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; cdm.<strong>GraphicsRedrawEnabled</strong> = True<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; Set cdg = cdm.<strong>CreateGroup</strong><br />
            &#160;&#160;&#160; Set cdg2 = cdm.<strong>CreateGroup</strong><br />
            &#160;&#160;&#160; Set cdg3 = cdm.<strong>CreateGroup</strong><br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; 'Holder<br />
            &#160;&#160;&#160; boolstatus = Part.Extension.SelectByID2("Holder-1@Spindleassem", "COMPONENT", 0, 0, 0, True, 0, Nothing, 0)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; TransformData(0) = 0.561729092855705<br />
            &#160;&#160;&#160; TransformData(1) = -0.827321235216108<br />
            &#160;&#160;&#160; TransformData(2) = 0<br />
            &#160;&#160;&#160; TransformData(3) = 0.827321235216108<br />
            &#160;&#160;&#160; TransformData(4) = 0.561729092855705<br />
            &#160;&#160;&#160; TransformData(5) = 0<br />
            &#160;&#160;&#160; TransformData(6) = 0<br />
            &#160;&#160;&#160; TransformData(7) = 0<br />
            &#160;&#160;&#160; TransformData(8) = 1#<br />
            &#160;&#160;&#160; TransformData(9) = 2.02097529022064E-02<br />
            &#160;&#160;&#160; TransformData(10) = 0.025899850979138<br />
            &#160;&#160;&#160; TransformData(11) = 0.1<br />
            &#160;&#160;&#160; TransformData(12) = 1<br />
            &#160;&#160;&#160; TransformData(13) = 0<br />
            &#160;&#160;&#160; TransformData(14) = 0<br />
            &#160;&#160;&#160; TransformData(15) = 0<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; TransformDataVariant = TransformData<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; 'Cutting tool<br />
            &#160;&#160;&#160; boolstatus = Part.Extension.SelectByID2("CuttingTool-1@Spindleassem", "COMPONENT", 0, 0, 0, True, 0, Nothing, 0)<br />
            &#160;&#160;<br />
            &#160;&#160;&#160; TransformData1(0) = 1<br />
            &#160;&#160;&#160; TransformData1(1) = 0<br />
            &#160;&#160;&#160; TransformData1(2) = 0<br />
            &#160;&#160;&#160; TransformData1(3) = 0<br />
            &#160;&#160;&#160; TransformData1(4) = 1<br />
            &#160;&#160;&#160; TransformData1(5) = 0<br />
            &#160;&#160;&#160; TransformData1(6) = 0<br />
            &#160;&#160;&#160; TransformData1(7) = 0<br />
            &#160;&#160;&#160; TransformData1(8) = 1<br />
            &#160;&#160;&#160; TransformData1(9) = -0.01<br />
            &#160;&#160;&#160; TransformData1(10) = -0.03<br />
            &#160;&#160;&#160; TransformData1(11) = 0.1<br />
            &#160;&#160;&#160; TransformData1(12) = 1<br />
            &#160;&#160;&#160; TransformData1(13) = 0<br />
            &#160;&#160;&#160; TransformData1(14) = 0<br />
            &#160;&#160;&#160; TransformData1(15) = 0<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; TransformDataVariant1 = TransformData1<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; 'Work piece<br />
            &#160;&#160;&#160; boolstatus = Part.Extension.SelectByID2("workpiece-1@Spindleassem", "COMPONENT", 0, 0, 0, True, 0, Nothing, 0)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; Set comp(0) = Part.SelectionManager.GetSelectedObjectsComponent4(1, -1)<br />
            &#160;&#160;&#160; Set comp1(0) = Part.SelectionManager.GetSelectedObjectsComponent4(2, -1)<br />
            &#160;&#160;&#160; Set comp2(0) = Part.SelectionManager.GetSelectedObjectsComponent4(3, -1)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; Dim swMathUtil As Object<br />
            &#160;&#160;&#160; Set swMathUtil = swApp.GetMathUtility()<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; Set transform(0) = swMathUtil.CreateTransform((TransformDataVariant))<br />
            &#160;&#160;&#160; Set transform1(0) = swMathUtil.CreateTransform((TransformDataVariant1))<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; longstatus = cdg.<strong>SetComponents</strong>(comp) 'Holder<br />
            &#160;&#160;&#160; longstatus = cdg2.<strong>SetComponents</strong>(comp1) 'Cutting tool<br />
            &#160;&#160;&#160; longstatus = cdg3.<strong>SetComponents</strong>(comp2) 'Work piece<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; 'Move the cutting tool and work piece</p>

            <p>&#160;&#160;&#160; longstatus = cdg.<strong>ApplyTransforms</strong>(transform)<br />
            &#160;&#160;&#160; longstatus = cdg2.<strong>ApplyTransforms</strong>(transform1)<br /></p>

            <p>&#160;&#160;&#160; 'Detect collisions<br />
            &#160;&#160;&#160;&#160;<br />
            &#160;&#160;&#160; longstatus = cdm.<strong>IsCollisionPresent</strong>(True) ' Treat coincidence as a collision<br />
            &#160;&#160;&#160; numCollisions = cdm.<strong>GetCollisions</strong>(True, var1)<br />
            &#160;&#160;&#160;<br />
            &#160;&#160;&#160; If numCollisions &gt; 0 Then<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 0 To (numCollisions - 1)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "Collision " &amp; (i + 1)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set aCollision = var1(i)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "&#160; Is penetrating? " &amp; aCollision.<strong>IsPenetrating</strong><br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; comps = aCollision.<strong>GetComponents</strong>()<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For j = 0 To UBound(comps)<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "&#160;&#160;&#160; " &amp; comps(j).Name<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next j<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Next i<br />
            &#160;&#160;&#160; Else<br />
            &#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print "No collisions present"<br />
            &#160;&#160;&#160; End If</p>

            <p>End Sub</p>

            <p></p>
        </div>

        <div class="i-section-heading" id="i-example-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Example</span>
        </div>

        <div id="i-example-section-content" class="i-section-content">
            <a href="Manage_Collision_Detection_Example_CSharp.htm">Manage Collision Detection (C#)</a>
        </div>

        <div class="i-section-heading" id="i-requirements-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">Requirements</span>
        </div>

        <div id="i-requirements-section-content" class="i-section-content">
            <p><b>Target Platforms:</b> Windows 7, Windows Vista SP1 or later, Windows XP SP3, Windows Server 2008 (Server Core not supported), Windows Server 2008 R2 (Server Core supported with SP1 or later), Windows Server 2003 SP2</p>
        </div><a name="seealsobookmark"></a>

        <div class="i-section-heading" id="i-seealso-section-heading">
            <span class="i-section-heading-icon"><!-- --></span><span class="i-section-heading-text">See Also</span>
        </div>

        <div id="i-seealso-section-content" class="i-section-content">
            <h4 class="i-sub-heading">Reference</h4>

            <p><a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager_members">ICollisionDetectionManager Members</a><br />
            <a href="ms-xhelp:///?id=SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks_namespace">SolidWorks.Interop.sldworks Namespace</a></p>
        </div>
    </div>

    <div id="i-footer-content" class="i-footer-content">
        <a href="mailto:support@company.com?subject=Documentation Feedback: SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ICollisionDetectionManager.html">Send Feedback</a>
    </div><script type="text/javascript">
//<![CDATA[
        $(function() {
            var documentInstance = new Innovasys.Content.Document(document.body);
            documentInstance.isNew = !(typeof setIsNew === "undefined");
            documentInstance.isResponsiveEnabled = !(typeof setIsResponsiveEnabled === "undefined");
            documentInstance.load();
        });
    //]]>
    </script>
</body>
</html>