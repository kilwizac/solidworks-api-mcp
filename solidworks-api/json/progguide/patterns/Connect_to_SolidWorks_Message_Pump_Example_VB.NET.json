{
  "frontmatter": {
    "type": "pattern",
    "title": "Connect to SOLIDWORKS Message Pump to Handle Keystrokes and Accelerator Keys (VB.NET)",
    "keywords": [
      "connect",
      "solidworks",
      "message",
      "pump",
      "handle",
      "keystrokes",
      "accelerator",
      "keys",
      "vb",
      "net"
    ],
    "categories": [
      "documents"
    ],
    "related": []
  },
  "title": "Connect to SOLIDWORKS Message Pump to Handle Keystrokes and Accelerator Keys (VB.NET)",
  "body": [
    "This example shows how to connect to a SOLIDWORKS message pump by creating, installing, and uninstalling a hook for a modeless dialog box or PropertyManager page for intercepting keystrokes and handling accelerator keys.",
    "",
    "## Code",
    "",
    "```vb",
    "' Create, install, and uninstall a hook for a modeless dialog box\n' or PropertyManager page for intercepting keystrokes and\n' handling accelerator keys\nImports System\nImports System.Runtime.InteropServices\nNamespace WinHooks\n    Public Class HookEventArgs\n        Inherits EventArgs\n        Public HookCode As Integer ' Hook code\n        Public wParam As IntPtr ' WPARAM argument\n        Public lParam As IntPtr ' LPARAM argument\n    End Class\n    ' Hook Types\n    Public Enum HookType\n        WH_JOURNALRECORD = 0\n        WH_JOURNALPLAYBACK = 1\n        WH_KEYBOARD = 2\n        WH_GETMESSAGE = 3\n        WH_CALLWNDPROC = 4\n        WH_CBT = 5\n        WH_SYSMSGFILTER = 6\n        WH_MOUSE = 7\n        WH_HARDWARE = 8\n        WH_DEBUG = 9\n        WH_SHELL = 10\n        WH_FOREGROUNDIDLE = 11\n        WH_CALLWNDPROCRET = 12\n        WH_KEYBOARD_LL = 13\n        WH_MOUSE_LL = 14\n    End Enum\n    Public Class LocalWindowsHook\n        ' Filter function delegate\n        Public Delegate Function HookProc(ByVal code As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer\n        ' Internal properties\n        Protected m_hhook As IntPtr = IntPtr.Zero\n        Protected m_filterFunc As HookProc = Nothing\n        Protected m_hookType As HookType\n        ' Event delegate\n        Public Delegate Sub HookEventHandler(ByVal sender As Object, ByVal e As HookEventArgs)\n        ' Event: HookInvoked\n        Public Event HookInvoked As HookEventHandler\n        Protected Sub OnHookInvoked(ByVal e As HookEventArgs)\n            RaiseEvent HookInvoked(Me, e)\n        End Sub\n        ' Class constructor(s)\n        Public Sub New(ByVal hook As HookType)\n            m_hookType = hook\n            m_filterFunc = New HookProc(AddressOf Me.CoreHookProc)\n        End Sub\n        Public Sub New(ByVal hook As HookType, ByVal func As HookProc)\n            m_hookType = hook\n            m_filterFunc = func\n        End Sub\n        ' Default filter function\n        Public Function CoreHookProc(ByVal code As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer\n            If code < 0 Then Return CallNextHookEx(m_hhook, code, wParam, lParam)\n            ' Let clients determine what to do\n            Dim e As HookEventArgs = New HookEventArgs()\n            e.HookCode = code\n            e.wParam = wParam\n            e.lParam = lParam\n            OnHookInvoked(e)\n            ' Yield to the next hook in the chain\n            CoreHookProc = CallNextHookEx(m_hhook, code, wParam, lParam)\n        End Function\n        ' Install the hook\n        Public Sub Install()\n            m_hhook = SetWindowsHookEx(m_hookType, m_filterFunc, IntPtr.Zero, AppDomain.GetCurrentThreadId())\n        End Sub\n        ' Uninstall the hook\n        Public Sub Uninstall()\n            UnhookWindowsHookEx(m_hhook)\n        End Sub\n        ' Win32 Imports\n        ' Win32: SetWindowsHookEx()\n        Declare Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" (ByVal code As HookType, ByVal func As HookProc, ByVal hInstance As IntPtr, ByVal threadID As Integer) As Integer\n        ' Win32: UnhookWindowsHookEx()\n        Declare Function UnhookWindowsHookEx Lib \"user32\" (ByVal hhook As IntPtr) As Integer\n        ' Win32: CallNextHookEx()\n        Declare Function CallNextHookEx Lib \"user32\" (ByVal hhook As IntPtr, ByVal code As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Integer\n    End Class\nEnd Namespace",
    "```",
    ""
  ]
}